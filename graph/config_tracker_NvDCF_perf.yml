%YAML:1.0
####################################################################################################
# SPDX-FileCopyrightText: Copyright (c) 2021 NVIDIA CORPORATION & AFFILIATES. All rights reserved.
# SPDX-License-Identifier: LicenseRef-NvidiaProprietary
#
# NVIDIA CORPORATION, its affiliates and licensors retain all intellectual
# property and proprietary rights in and to this material, related
# documentation and any modifications thereto. Any use, reproduction,
# disclosure or distribution of this material and related documentation
# without an express license agreement from NVIDIA CORPORATION or
# its affiliates is strictly prohibited.
####################################################################################################

BaseConfig:
  # הגב קצת את הסף כדי לסנן דיטקציות חלשות מאוד (מקטין “רעש” שמפיל טרקינג)
  minDetectorConfidence: 0.025    # If the confidence of a detector bbox is lower than this, then it won't be considered for tracking

TargetManagement:
  enableBboxUnClipping: 1    # In case the bbox is likely to be clipped by image border, unclip bbox
  
  enableNvDCF: 1
  
  preserveStreamUpdateOrder: 0    # When assigning new target ids, preserve input streams' order to keep target ids in a deterministic order over multuple runs
  maxTargetsPerStream: 50    # Max number of targets to track per stream. Recommended to set >10. Note: this value should account for the targets being tracked in shadow mode as well. Max value depends on the GPU memory capacity

  # יצירה/סיום
  # אל תשלול דיטקציה חדשה אם היא חופפת לישנה בפחות מ~70% – זה עוזר כשבוקסים קופצים מעט
  # [Creation & Termination Policy]
  minIouDiff4NewTarget: 0.70    # If the IOU between the newly detected object and any of the existing targets is higher than this threshold, this newly detected object will be discarded.
  # אל תוריד מהר ל-shadow: הורד מעט את הסף כדי להשאיר Track גם כשחלשה דיטקציה רגעית
  minTrackerConfidence: 0.3    # If the confidence of an object tracker is lower than this on the fly, then it will be tracked in shadow mode. Valid Range: [0.0, 1.0]
  probationAge: 2    # If the target's age exceeds this, the target will be considered to be valid.
  # תן ל-Track “להישרד” עוד זמן כשהאובייקט נעלם זמנית (הסתרה/Blur)
  maxShadowTrackingAge: 60    # Max length of shadow tracking. If the shadowTrackingAge exceeds this limit, the tracker will be terminated.
  # אל תסיים מהר מדי ב-TENTATIVE
  maxShadowTrackingAgeNotVisible: 120
  earlyTerminationAge: 2    # If the shadowTrackingAge reaches this threshold while in TENTATIVE period, the target will be terminated prematurely.

#מרחק השוואה
minMatchingScore4NewObject: 0.5   # הורד מ-0.7
minMatchingScore4Track: 0.3       # הורד מ-0.5


TrajectoryManagement:
  # מזהה 64bit – לא חובה, אבל נוח לריצה ארוכה/מספר סטרימים
  useUniqueID: 0    # Use 64-bit long Unique ID when assignining tracker ID.

DataAssociator:
  dataAssociatorType: 0    # the type of data associator among { DEFAULT= 0 }
  associationMatcherType: 1   # CASCADED    # the type of matching algorithm among { GREEDY=0, CASCADED=1 }
  checkClassMatch: 1    # If checked, only the same-class objects are associated with each other. Default: true

  # ספי התאמה – מעט “נדיבים” כדי לא לאבד התאמה, במיוחד כשבוקסים זזים
  # [Association Metric: Thresholds for valid candidates]
  minMatchingScore4Overall: 0.35    # Min total score
  minMatchingScore4SizeSimilarity: 0.30    # Min bbox size similarity score
  minMatchingScore4Iou: 0.25    # Min IOU score
  minMatchingScore4VisualSimilarity: 0.45    # Min visual similarity score

  # משקולות – תן לאיור/מידע חזותי משקל לא רע כדי להפחית ID switch
  # [Association Metric: Weights]
  matchingScoreWeight4VisualSimilarity: 0.40    # Weight for the visual similarity (in terms of correlation response ratio)
  matchingScoreWeight4SizeSimilarity: 0.35    # Weight for the Size-similarity score
  matchingScoreWeight4Iou: 0.35    # Weight for the IOU score

  # לטנטטיב – דרוש קצת פחות IOU כדי “לתפוס” חזרה אחרי קפיצה קלה
  # [Association Metric: Tentative detections] only uses iou similarity for tentative detections
  tentativeDetectorConfidence: 0.30    # If a detection's confidence is lower than this but higher than minDetectorConfidence, then it's considered as a tentative detection
  minMatchingScore4TentativeIou: 0.40    # Min iou threshold to match targets and tentative detection

StateEstimator:
  stateEstimatorType: 1     # SIMPLE    # the type of state estimator among { DUMMY=0, SIMPLE=1, REGULAR=2 }

  # רעשים – ערכי ברירת המחדל סבירים; אם יש “רעד” חזק בבוקסים אפשר להוריד מעט את processNoiseVar4Loc/Size
  # [Dynamics Modeling]
  processNoiseVar4Loc: 1.2    # Process noise variance for bbox center
  processNoiseVar4Size: 1.0    # Process noise variance for bbox size
  processNoiseVar4Vel: 0.03    # Process noise variance for velocity
  measurementNoiseVar4Detector: 3.0    # Measurement noise variance for detector's detection
  measurementNoiseVar4Tracker: 8.0    # Measurement noise variance for tracker's localization

VisualTracker:
  visualTrackerType: 1    # NvDCF    # the type of visual tracker among { DUMMY=0, NvDCF=1 }

  # [NvDCF: Feature Extraction]
  useColorNames: 1    # Use ColorNames feature
  useHog: 0    # Use Histogram-of-Oriented-Gradient (HOG) feature
  # תן לפיצ’ר להיות טיפה גדול יותר – יותר יציב, מעט יקר יותר חישובית
  featureImgSizeLevel: 3    # Size of a feature image. Valid range: {1, 2, 3, 4, 5}, from the smallest to the largest
  featureFocusOffsetFactor_y: -0.2    # The offset for the center of hanning window relative to the feature height. The center of hanning window would move by (featureFocusOffsetFactor_y*featureMatSize.height) in vertical direction

  # קצבי למידה – קטנים יותר => פחות Drift ופחות “קפיצות” זהות
  # [NvDCF: Correlation Filter]
  filterLr: 0.040    # learning rate for DCF filter in exponential moving average. Valid Range: [0.0, 1.0]
  filterChannelWeightsLr: 0.060    # learning rate for the channel weights among feature channels. Valid Range: [0.0, 1.0]
  gaussianSigma: 0.75    # Standard deviation for Gaussian for desired response when creating DCF filter [pixels]
